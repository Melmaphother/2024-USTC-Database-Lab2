<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>USTC 银行 - 储蓄账户</title>
    <base href="/dashboard/">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'css/dashboard/savings.css' %}">
    <script src="{% static 'js/dashboard.js' %}"></script>
    <script src="{% static 'js/dashboard/savings.js' %}"></script>
</head>
<body>
<div id="pageContent">
    <div class="sidebar">
        <div class="bank-info">
            {% load static %}
            <img src="{% static 'image/logo.png' %}" alt="Bank Logo">
            <span>USTC 银行</span>
            <div class="separator"></div>
        </div>
        <button onclick="goToPage('');">账户查询</button>
        <button onclick="goToPage('profile');">个人主页</button>
        <button onclick="goToPage('savings');" class="onclick">储蓄账户</button>
        <button onclick="goToPage('credit')">信用卡账户</button>
        <button onclick="goToPage('loan')">贷款账户</button>
        <button onclick="openLogoutModal()" class="logout-btn">登出</button>
    </div>
    <div class="main-content">
        <div class="header">
            <h1>你好，{{ c_name }}!</h1>
            <img src="{{ MEDIA_URL }}{{ c_avatar }}" alt="User Avatar">
        </div>
        <div class="account-header">
            <h3>储蓄账户</h3>
            <button onclick="openAddAccountModal()">添加账户</button>
        </div>
        <div>
            {% if messages %}
                {% for message in messages %}
                    {% if forloop.last %}
                        <p class="error-message">{{ message }}</p>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>

        <!-- 账户信息列表 -->
        <div class="account-details">
            {% for account in SavingsAccount %}
                <div class="account">
                    <p class="account-number">账户号：{{ account.a_no }}</p>
                    <div class="account-row">
                        <p>余额：{{ account.formatted_balance }}</p>
                        <p>开户银行：{{ account.a_open_b_name }}</p>
                        <p>开户时间：{{ account.a_open_time }}</p>
                    </div>
                    <div class="account-row">
                        <p>利率：{{ account.sa_rate }}</p>
                        <p>提款额度：{{ account.sa_withdraw_limit }}</p>
                        <p></p>
                    </div>
                    <div class="button-row">
                        <button onclick="openDepositModal(this)" data-account-number="{{ account.a_no }}"
                                class="deposit">存款
                        </button>
                        <button onclick="openWithdrawModal()" class="withdraw">取款</button>
                        <button onclick="openTransferModal()" class="transfer">转账</button>
                    </div>
                </div>
            {% empty %}
                <h3 class="empty-savings-message">没有储蓄账户信息</h3>
            {% endfor %}
        </div>
    </div>
</div>
<div id="logoutModal" class="modal">
    <div class="modal-content">
        <h2>确认要登出吗？</h2>
        <div class="button-container">
            <button onclick="logout()" class="confirm">确认</button>
            <button onclick="closeLogoutModal()" class="cancel">取消</button>
        </div>
    </div>
</div>
<div id="addAccountModal" class="modal">
    <div class="business-modal-content add-account-modal-content">
        <h2 class="add-account">添加账户</h2>
        <form action="/savings_account_add/" method="post">
            {% csrf_token %}
            <div class="input-form-group">
                <label for="open_b_name">开户银行：</label>
                <select id="open_b_name" name="open_b_name" required>
                    <option value="东区银行">东区银行</option>
                    <option value="西区银行">西区银行</option>
                    <option value="中区银行">中区银行</option>
                    <option value="高新区银行" selected>高新区银行</option>
                </select>
            </div>
            <div class="input-form-group">
                <label for="currency">货币类型：</label>
                <select id="currency" name="currency" required>
                    <option value="CNY" selected>CNY</option>
                    <option value="USD">USD</option>
                    <option value="GBP">GBP</option>
                    <option value="EUR">EUR</option>
                </select>
            </div>
            <div class="input-form-group">
                <label for="rate">利率：</label>
                <select id="rate" name="rate" required>
                    <option value="1" selected>1%</option>
                    <option value="2">2%</option>
                    <option value="3">3%</option>
                    <option value="4">4%</option>
                    <option value="5">5%</option>
                </select>
            </div>
            <div class="input-form-group">
                <label for="withdraw_limit">提款额度：</label>
                <select id="withdraw_limit" name="withdraw_limit" required>
                    <option value="10000" selected>10000</option>
                    <option value="50000">50000</option>
                    <option value="100000">100000</option>
                </select>
            </div>
            <div class="input-form-group">
                <label for="password">设置密码：</label>
                <input type="password" id="password" name="password" placeholder="密码请设置为6位" required>
            </div>
            <div class="input-form-group">
                <label for="confirm_password">确认密码：</label>
                <input type="password" id="confirm_password" name="confirm_password" required>
            </div>
            <div class="button-container">
                <button type="submit" class="confirm">确认添加</button>
                <button type="button" onclick="closeAddAccountModal()" class="cancel">取消</button>
            </div>
        </form>
    </div>
</div>
<div id="depositModal" class="modal">
    <div class="business-modal-content">
        <h2 class="deposit">存款</h2>
        <h3>账户号：<span id="depositAccountNumber"></span></h3>
        <form action="/savings_account_deposit/" method="post">
            {% csrf_token %}
            <input type="hidden" id="hiddenAccountNumber" name="a_no">
            <div class="input-form-group">
                <label for="amount">存款金额：</label>
                <input type="text" id="amount" name="amount" required>
            </div>
            <div class="input-form-group">
                <label for="password">账户密码：</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="button-container">
                <button type="submit" class="confirm">确认</button>
                <button type="button" onclick="closeDepositModal()" class="cancel">取消</button>
            </div>
        </form>
    </div>
</div>
<div id="withdrawModal" class="modal">
    <div class="business-modal-content">
        <h2 class="withdraw">取款</h2>
        <h3>账户号：1234</h3>
        <form action="" method="post">
            {% csrf_token %}
            <div class="input-form-group">
                <label for="amount">取款金额：</label>
                <input type="text" id="amount" name="amount" required>
            </div>
            <div class="input-form-group">
                <label for="password">账户密码：</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="button-container">
                <button type="submit" class="confirm">确认</button>
                <button type="button" onclick="closeWithdrawModal()" class="cancel">取消</button>
            </div>
        </form>
    </div>
</div>
<div id="transferModal" class="modal">
    <div class="business-modal-content transfer-modal-content">
        <h2 class="transfer">转账</h2>
        <h3>账户号：1234</h3>
        <form action="" method="post">
            {% csrf_token %}
            <div class="input-form-group">
                <label for="amount">转账金额：</label>
                <input type="text" id="amount" name="amount" required>
            </div>
            <div class="input-form-group">
                <label for="target">目标账户号：</label>
                <input type="text" id="target" name="target" required>
            </div>
            <div class="input-form-group">
                <label for="password">账户密码：</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="button-container">
                <button type="submit" class="confirm">确认</button>
                <button type="button" onclick="closeTransferModal()" class="cancel">取消</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>
